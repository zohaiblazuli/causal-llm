# Core ML and Deep Learning
# Tested versions from working environment (October 2025)
torch>=2.0.0,<3.0.0  # Tested: 2.7.1+cu118
transformers>=4.35.0,<5.0.0  # Tested: 4.55.0
peft>=0.7.0,<1.0.0  # For LoRA - Tested: 0.17.1
bitsandbytes>=0.41.0,<1.0.0  # For 4-bit quantization - Tested: 0.48.1
accelerate>=0.24.0,<2.0.0  # Tested: 1.10.1

# Causal Inference
# IMPORTANT: NumPy 2.x requires SciPy >=1.14.1 (avoiding compatibility warnings)
numpy>=1.24.0,<2.3.0  # Tested: 2.3.2 (compatible with SciPy 1.14.1)
scipy>=1.14.0,<2.0.0  # Tested: 1.14.1 (supports NumPy 2.x)
scikit-learn>=1.3.0,<2.0.0  # Tested: 1.5.1
networkx>=3.1,<4.0  # For causal graphs - Tested: 3.4.2
pgmpy>=0.1.23  # For causal discovery (PC, GES algorithms)

# Data Processing
pandas>=2.0.0,<3.0.0  # Tested: 2.2.2
datasets>=2.14.0,<5.0.0  # Tested: 4.0.0

# Evaluation and Metrics
tqdm>=4.66.0  # Tested: 4.67.1
wandb>=0.15.0  # For experiment tracking (optional)

# Visualization
matplotlib>=3.7.0
seaborn>=0.12.0
plotly>=5.17.0

# Testing and Validation
pytest>=7.4.0
pytest-cov>=4.1.0

# Type Checking and Code Quality (Development only)
mypy>=1.5.0
black>=23.9.0
flake8>=6.1.0
isort>=5.12.0

# Utilities
pyyaml>=6.0,<7.0  # Tested: 6.0.2
python-dotenv>=1.0.0
typing-extensions>=4.8.0

# Optional: For PAC-Bayesian bounds (Phase 3)
# torch-pac-bayes>=0.1.0  # May need to install from source

# Optional: For causal discovery (Phase 3)
causal-learn>=0.1.3.3

# CUDA Compatibility Notes:
# - torch 2.7.1 tested with CUDA 11.8
# - For CUDA 12.1, use: pip install torch --index-url https://download.pytorch.org/whl/cu121
# - bitsandbytes requires CUDA-capable GPU for 4-bit quantization

# Installation order for best compatibility:
# 1. pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
# 2. pip install -r requirements.txt
